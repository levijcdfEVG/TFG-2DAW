<div class="container-fluid">
    <!-- User Filter -->
    <div class="card rounded-0 my-3 mx-4">
        <div class="card-header font-weight-bold bg-light">
            <div class="row fs-6">
                <div class="col-6">
                    <h5 class="mb-0">Filtro de Usuarios</h5>
                </div>
                <div class="col-6 text-end font-weight-bold">
                    <a data-target="#newUserModal" data-toggle="modal" style="cursor: pointer;">
                        <i class="fa fa-plus me-2"></i>Nuevo Usuario
                    </a>
                    
                </div>
            </div>
        </div>
        <div class="card-body">
            <form [formGroup]="filterForm" (ngSubmit)="applyFilter()">
                <div class="row mb-3">
                    <div class="col-md-4 d-flex align-items-center mb-2 mb-md-0">
                        <label for="nombre" class="form-label fw-bold mb-0 me-3" style="min-width: 110px;">Nombre:</label>
                        <input type="text" class="form-control" id="nombre" formControlName="nombre">
                    </div>
                    <div class="col-md-4 d-flex align-items-center mb-2 mb-md-0">
                        <label for="apellidos" class="form-label fw-bold mb-0 me-3" style="min-width: 110px;">Apellidos:</label>
                        <input type="text" class="form-control" id="apellidos" formControlName="apellidos">
                    </div>
                    <div class="col-md-4 d-flex align-items-center">
                        <label class="form-label fw-bold mb-0 me-3" style="min-width: 110px;">Nuevo Educador:</label>
                        <div class="d-flex gap-2">
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" id="nuevoEducadorTodos" formControlName="nuevo_educador" [value]="null">
                                <label class="form-check-label" for="nuevoEducadorTodos">Todos</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" id="nuevoEducadorSi" formControlName="nuevo_educador" [value]="true">
                                <label class="form-check-label" for="nuevoEducadorSi">Sí</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" id="nuevoEducadorNo" formControlName="nuevo_educador" [value]="false">
                                <label class="form-check-label" for="nuevoEducadorNo">No</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-4 d-flex align-items-center mb-2 mb-md-0">
                        <label for="email" class="form-label fw-bold mb-0 me-3" style="min-width: 110px;">Email:</label>
                        <input type="email" class="form-control" id="email" formControlName="email">
                    </div>
                    <div class="col-md-4 d-flex align-items-center mb-2 mb-md-0">
                        <label for="telefono" class="form-label fw-bold mb-0 me-3" style="min-width: 110px;">Teléfono:</label>
                        <input type="tel" class="form-control" id="telefono" formControlName="telefono">
                    </div>
                    <div class="col-md-4 d-flex align-items-center">
                        <label class="form-label fw-bold mb-0 me-3" style="min-width: 110px;">Estado:</label>
                        <div class="d-flex gap-2">
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" id="estadoTodos" formControlName="estado" [value]="null">
                                <label class="form-check-label" for="estadoTodos">Todos</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" id="estadoActivo" formControlName="estado" [value]="true">
                                <label class="form-check-label" for="estadoActivo">Activo</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input " type="radio" id="estadoInactivo" formControlName="estado" [value]="false">
                                <label class="form-check-label" for="estadoInactivo">Inactivo</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-4 d-flex align-items-center">
                        <label for="rol" class="form-label fw-bold mb-0 me-3" style="min-width: 110px;">Rol:</label>
                        <select class="form-select" id="rol" formControlName="rol">
                            <option value="">Todos</option>
                            <option value="admin">Administrador</option>
                            <option value="user">Usuario</option>
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 text-end">
                        <button type="submit" class="btn btn-primary me-2" [disabled]="!filterForm.valid">Filtrar</button>
                        <button type="button" class="btn btn-secondary" (click)="resetFilter()">Limpiar</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Users Table -->
    <div class="card" *ngIf="hasSearched">
        <div class="card-body">
            <div *ngIf="users.length > 0; else noResults">
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nombre</th>
                                <th>Apellidos</th>
                                <th>Email</th>
                                <th>Teléfono</th>
                                <th>Rol</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let user of users">
                                <td>{{user.id}}</td>
                                <td>{{user.nombre}}</td>
                                <td>{{user.apellidos}}</td>
                                <td>{{user.email}}</td>
                                <td>{{user.telefono}}</td>
                                <td>{{user.rol}}</td>
                                <td>
                                    <span class="badge" [ngClass]="user.estado ? 'bg-success' : 'bg-danger'">
                                        {{user.estado ? 'Activo' : 'Inactivo'}}
                                    </span>
                                </td>
                                <td>
                                    <div class="dropdown">
                                        <button class="btn btn-link" type="button" data-bs-toggle="dropdown">
                                            <i class="bi bi-three-dots-vertical"></i>
                                        </button>
                                        <ul class="dropdown-menu">
                                            <li><a class="dropdown-item" [routerLink]="['/user', user.id]">Ver detalles</a></li>
                                        </ul>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Pagination -->
                <div class="d-flex justify-content-between align-items-center mt-3">
                    <div>
                        Mostrando {{users.length}} de {{totalUsers}} usuarios
                    </div>
                    <nav aria-label="Page navigation">
                        <ul class="pagination mb-0">
                            <li class="page-item" [class.disabled]="currentPage === 1">
                                <a class="page-link" (click)="changePage(currentPage - 1)">Anterior</a>
                            </li>
                            <li class="page-item" *ngFor="let page of [].constructor(totalPages); let i = index">
                                <a class="page-link" (click)="changePage(i + 1)">{{i + 1}}</a>
                            </li>
                            <li class="page-item" [class.disabled]="currentPage === totalPages">
                                <a class="page-link" (click)="changePage(currentPage + 1)">Siguiente</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
            <ng-template #noResults>
                <div class="alert alert-info text-center">
                    <i class="bi bi-info-circle me-2"></i>
                    No se encontraron usuarios con los criterios de búsqueda especificados.
                </div>
            </ng-template>
        </div>
    </div>
</div>
